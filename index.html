<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title>RobotC Precompiler</title>
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/bootstrap-responsive.min.css">
		<link rel="stylesheet" href="css/main.css">
 	</head>
	
	
	<body onload = "Initialize();">
	
	<!-- Modal -->
	<div id="Modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-header">
			<h2 id="myModalLabel">Help Menu</h2>
		</div>
		
		<div class="modal-body">
			<h4>New Projects</h4>
			<p>To create a new project, press the New Project button underneath the website title.</p>
			<h4>Adding blocks</h4>
			<p>EasyC uses code blocks to simulate how real RobotC works. To add a block, navigate to the heading titled 'This is where you will add blocks.'. First, select the block type. You can choose to Sleep for a few seconds, turn a motor a certain number of rotations, or move a motor at a certain speed. Once you have selected the correct block type, fill in the text boxes below it, putting in the values listed in the boxes. To add your text box, just press add, and it will automatically be drawn to the right so you can see how your program looks so far.</p>
			<h4>Converting to RobotC</h4>
			<p>Converting EasyC to RobotC is quite simple. Once you like the looks of your program, just copy all the code in the text box under the heading 'This is where your output text will be.', and paste it into RobotC. Set up the communication with the Nxt brick like you suually would, and run the code. It will work as if it were normal RobotC code.</p>
		</div>
		
		<div class="modal-footer">
			<button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
		</div>
	</div>
	
	<div class = "row span12 hero-unit">
		<h1>Welcome to EasyC,</h1>
		<h4>A project to make writing code for RobotC as easy as breathing.</h4>
		<div class="btn-group">
			<button class="btn btn-large" onClick="RefreshPage();">New Project</button>
			<button class="btn btn-large" href = "mailto:izinda@hotmail.com?Subject=EasyC">Contact Isaac</button>
			<button class="btn btn-large" onclick = "ShowModal();">Help</button>
		</div>
	</div>
		<div class = "row">
			<div class = "span4">
				<h5>This is where you will see your program.</h5>
				<canvas id = 'canvas' height = "1000" width = "310" >Canvas not supported</canvas>
			</div>
			<div class = "span4">
				<h5>This is where you will add blocks.</h5>
				<select>
					<option onclick = "Sleep();">Sleep</option>
					<option onclick = "TurnRotations();">TurnRotations</option>
					<option onclick = "MoveSpeed();">MoveSpeed</option>
				</select>
				
				<div id = "Sleep">
					<input type="text" id = "SleepSeconds" placeholder="Seconds to sleep">
				</div>
				
				<div id = "TurnRotations">
					<input type="text" id = "TurnRotationsSpeed" placeholder="Speed to turn at">
					<input type="text" id = "TurnRotationsNumber" placeholder="Number of rotations to turn">
					<input type="text" id = "TurnRotationsPort" placeholder="Motor port">
					<input type="text" id = "TurnRotationsMotor" placeholder="Motor number">
				</div>
				
				<div id = "MoveSpeed">
					<input type="text" id = "MoveSpeedSpeed" placeholder="Speed to move at">
					<input type="text" id = "MoveSpeedPort" placeholder="Motor port">
					<input type="text" id = "MoveSpeedMotor" placeholder="Motor number">
				</div>
				
				<button class="btn" onclick = "Add();">Add</button>
			
			</div>
			<div class = "span4">
				<h5>This is where your output text will be.</h5>
				<textarea id = "TextArea" rows="20"></textarea>
			</div>
		</div>
		
		<p id = "LibrariesText" hidden = "True">
typedef ubyte tByteArray[17];

void writeI2C(tSensors link, tByteArray &request)
{
	sendI2CMsg(link, &request[0], 0);
}

void writeI2C(tSensors link, tByteArray &request, tByteArray &reply, int replylen)
{
	sendI2CMsg(link, &request[0], replylen);
	readI2CReply(link, &reply[0], replylen);
}

void setMotorSpeed(sbyte Speed, tSensors port, int MotorNumber)
{
	tByteArray I2Crequest;
	I2Crequest[0] = 3;
	I2Crequest[1] = 0x2;
	if(MotorNumber == 1)
	{
		I2Crequest[2] = 0x45;
	}
	else
	{
		I2Crequest[2] = 0x46;
	}
	I2Crequest[3] = Speed;
	writeI2C(port, I2Crequest);
}

long getEncoderPosition(int motor, tSensors port, int daisychainLevel = 0)
{
		tByteArray I2Crequest;
		tByteArray I2Cresponse;
		I2Crequest[0] = 2;
	  I2Crequest[1] = 0x02 + daisychainLevel*2;
	  if (motor == 1)
	  {
	  	I2Crequest[2] = 0x49;
		} else {
		  I2Crequest[2] = 0x50;
		}
	  writeI2C(port, I2Crequest, I2Cresponse, 4);
	  long EncoderValue = (I2Cresponse[0] << 24) + (I2Cresponse[1] << 16) + (I2Cresponse[2] << 8) + (I2Cresponse[3] << 0);
  	return EncoderValue;
}

void setEncoderPosition(int motor, tSensors port, long Input)
{
	int daisychainLevel = 1;
	tByteArray I2Crequest;
	I2Crequest[0] = 8;
  I2Crequest[1] = 0x02 + daisychainLevel*2;
  if (motor == 1)
  {
  	I2Crequest[2] = 0x45;
	} else {
  	I2Crequest[2] = 0x46;
  }
  I2Crequest[3] = 0b00010000;
  I2Crequest[4] = 0b00000010;
  I2Crequest[5] = (byte)((Input >> 24) & 0x000000ff);
  I2Crequest[6] = (byte)((Input >> 16) & 0x000000ff);
  I2Crequest[7] = (byte)((Input >> 8) & 0x000000ff);
  I2Crequest[8] = (byte)(Input & 0x000000ff);
  writeI2C(S1, I2Crequest);
}
</p>
	</body>
	
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<script>window.jQuery || document.write('<script src="js/jquery-1.9.1.min.js"><\/script>')</script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/main.js"></script>
</html>
